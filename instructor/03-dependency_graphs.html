<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Introduction to Workflows with Common Workflow Language: Developing Multi-Step Workflows</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav "><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="" src="../assets/images/-logo.svg"><abbr class="badge badge-light" title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team." style="background-color: #001483; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link" style="color: #FFF7F1">
            <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
            Beta
          </a>
          <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../03-dependency_graphs.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav " aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="" src="../assets/images/-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Introduction to Workflows with Common Workflow Language
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Introduction to Workflows with Common Workflow Language
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr></ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to Workflows with Common Workflow Language
</div>

<aside class="col-md-12 lesson-progress"><div style="width: NaN%" class="percentage">
    NaN%
  </div>
  <div class="progress ">
    <div class="progress-bar " role="progressbar" style="width: NaN%" aria-valuenow="NaN" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../03-dependency_graphs.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-shell_to_cwl.html">2. CWL and Shell Tools</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        3. Developing Multi-Step Workflows
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#multi-step-workflow">Multi-Step Workflow</a></li>
<li><a href="#validating-the-workflow">Validating the workflow</a></li>
<li><a href="#running-the-new-workflow">Running the new workflow</a></li>
<li><a href="#visualising-a-workflow">Visualising a workflow</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-reusing_tools.html">4. Resources for Reusing Tools and Scripts</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="addendum-01-debug.html">5. Debugging Workflows</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="more_info.html">6. More Information</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr></ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-shell_to_cwl.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-reusing_tools.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-shell_to_cwl.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: CWL and Shell Tools
        </a>
        <a class="chapter-link float-end" href="../instructor/04-reusing_tools.html" rel="next">
          Next: Resources for... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Developing Multi-Step Workflows</h1>
        <p>Last updated on 2024-05-21 |
        
        <a href="https://github.com/__USERNAME__/__PROJECT__/edit/main/episodes/03-dependency_graphs.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 0 minutes</p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can we expand to a multi-step workflow?</li>
<li>What is iterative workflow development?</li>
<li>How to use workflows as dependency graphs?</li>
<li>How to use sketches for workflow design?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain that a workflow is a dependency graph</li>
<li>Use cwlviewer online</li>
<li>Generate Graphviz diagram using cwltool</li>
<li>Exercise with the printout of a simple workflow; draw arrows on
code; hand draw a graph on another sheet of paper</li>
<li>Recognise that workflow development can be iterative i.e. that it
doesn’t have to happen all at once</li>
<li>Understand the flow of data between tools</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="multi-step-workflow"><h2 class="section-heading">Multi-Step Workflow<a class="anchor" aria-label="anchor" href="#multi-step-workflow"></a>
</h2>
<hr class="half-width"><p>In the previous episode we worked through a single step workflow,
carrying out quality control check on RNA reads of the fruitfly genome.
In this episode the workflow is extended with an equivalent reverse RNA
reads and the next two steps of the RNA-sequencing analysis, trimming
the reads and aligning the trimmed reads, are added. We will be using
the <a href="https://bio.tools/cutadapt" class="external-link"><code>cutadapt</code></a> and
<a href="https://bio.tools/star" class="external-link"><code>STAR</code></a> tools for these
tasks.</p>
<p>To make a multi-step workflow that can carry all this analysis out,
we add more entries to the <code>steps</code> field.</p>
<div id="naming-steps" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="naming-steps" class="callout-inner">
<h3 class="callout-title">Naming steps<a class="anchor" aria-label="anchor" href="#naming-steps"></a>
</h3>
<div class="callout-content">
<p>Note that when the <code>quality_control</code> step is duplicated
the two steps are named <code>quality_control_forward</code> and
<code>quality_control_reverse</code>, to distinguish the separate
forward and reverse RNA reads. Likewise, the
<code>rna_reads_fruitfly</code> input becomes
<code>rna_reads_fruitfly_forward</code>, and an
<code>rna_reads_fruitfly_reverse</code> input is added.</p>
</div>
</div>
</div>
<div id="accordionSpoiler1" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler1" aria-expanded="false" aria-controls="collapseSpoiler1">
  <h3 class="accordion-header" id="headingSpoiler1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>rna_seq_workflow_2.cwl (Click to expand)</h3>
</button>
<div id="collapseSpoiler1" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler1" aria-labelledby="headingSpoiler1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">cwlVersion</span><span class="kw">:</span><span class="at"> v1.2</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">class</span><span class="kw">:</span><span class="at"> Workflow</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="at">  </span><span class="fu">rna_reads_fruitfly_forward</span><span class="kw">:</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> File</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="at">    </span><span class="fu">format</span><span class="kw">:</span><span class="at"> http://edamontology.org/format_1930</span><span class="co">  # FASTQ</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="at">  </span><span class="fu">rna_reads_fruitfly_reverse</span><span class="kw">:</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> File</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="at">    </span><span class="fu">format</span><span class="kw">:</span><span class="at"> http://edamontology.org/format_1930</span><span class="co">  # FASTQ</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="at">  </span><span class="fu">ref_fruitfly_genome</span><span class="kw">:</span><span class="at"> Directory</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="at">  </span><span class="fu">fruitfly_gene_model</span><span class="kw">:</span><span class="at"> File</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="at">  </span><span class="fu">quality_control_forward</span><span class="kw">:</span></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="at">    </span><span class="fu">run</span><span class="kw">:</span><span class="at"> bio-cwl-tools/fastqc/fastqc_2.cwl</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a><span class="at">    </span><span class="fu">in</span><span class="kw">:</span></span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="at">      </span><span class="fu">reads_file</span><span class="kw">:</span><span class="at"> rna_reads_fruitfly_forward</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="at">    </span><span class="fu">out</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">html_file</span><span class="kw">]</span></span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a><span class="at">  </span><span class="fu">quality_control_reverse</span><span class="kw">:</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a><span class="at">    </span><span class="fu">run</span><span class="kw">:</span><span class="at"> bio-cwl-tools/fastqc/fastqc_2.cwl</span></span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="at">    </span><span class="fu">in</span><span class="kw">:</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a><span class="at">      </span><span class="fu">reads_file</span><span class="kw">:</span><span class="at"> rna_reads_fruitfly_reverse</span></span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a><span class="at">    </span><span class="fu">out</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">html_file</span><span class="kw">]</span></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a><span class="at">  </span><span class="fu">trim_low_quality_bases</span><span class="kw">:</span></span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="at">    </span><span class="fu">run</span><span class="kw">:</span><span class="at"> bio-cwl-tools/cutadapt/cutadapt-paired.cwl</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a><span class="at">    </span><span class="fu">in</span><span class="kw">:</span></span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a><span class="at">      </span><span class="fu">reads_1</span><span class="kw">:</span><span class="at"> rna_reads_fruitfly_forward</span></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a><span class="at">      </span><span class="fu">reads_2</span><span class="kw">:</span><span class="at"> rna_reads_fruitfly_reverse</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a><span class="at">      </span><span class="fu">minimum_length</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">default</span><span class="kw">:</span><span class="at"> </span><span class="dv">20</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="at">      </span><span class="fu">quality_cutoff</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">default</span><span class="kw">:</span><span class="at"> </span><span class="dv">20</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a><span class="at">    </span><span class="fu">out</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> trimmed_reads_</span><span class="dv">1</span><span class="kw">,</span><span class="at"> trimmed_reads_</span><span class="dv">2</span><span class="kw">,</span><span class="at"> report </span><span class="kw">]</span></span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a><span class="at">  </span><span class="fu">mapping_reads</span><span class="kw">:</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="at">      </span><span class="fu">ResourceRequirement</span><span class="kw">:</span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a><span class="at">        </span><span class="fu">ramMin</span><span class="kw">:</span><span class="at"> </span><span class="dv">5120</span></span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a><span class="at">    </span><span class="fu">run</span><span class="kw">:</span><span class="at"> bio-cwl-tools/STAR/STAR-Align.cwl</span></span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a><span class="at">    </span><span class="fu">in</span><span class="kw">:</span></span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a><span class="at">      </span><span class="fu">RunThreadN</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">default</span><span class="kw">:</span><span class="at"> </span><span class="dv">4</span><span class="kw">}</span></span>
<span id="cb1-43"><a href="#cb1-43" tabindex="-1"></a><span class="at">      </span><span class="fu">GenomeDir</span><span class="kw">:</span><span class="at"> ref_fruitfly_genome</span></span>
<span id="cb1-44"><a href="#cb1-44" tabindex="-1"></a><span class="at">      </span><span class="fu">ForwardReads</span><span class="kw">:</span><span class="at"> trim_low_quality_bases/trimmed_reads_1</span></span>
<span id="cb1-45"><a href="#cb1-45" tabindex="-1"></a><span class="at">      </span><span class="fu">ReverseReads</span><span class="kw">:</span><span class="at"> trim_low_quality_bases/trimmed_reads_2</span></span>
<span id="cb1-46"><a href="#cb1-46" tabindex="-1"></a><span class="at">      </span><span class="fu">OutSAMtype</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">default</span><span class="kw">:</span><span class="at"> BAM</span><span class="kw">}</span></span>
<span id="cb1-47"><a href="#cb1-47" tabindex="-1"></a><span class="at">      </span><span class="fu">SortedByCoordinate</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">default</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span><span class="kw">}</span></span>
<span id="cb1-48"><a href="#cb1-48" tabindex="-1"></a><span class="at">      </span><span class="fu">OutSAMunmapped</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">default</span><span class="kw">:</span><span class="at"> Within</span><span class="kw">}</span></span>
<span id="cb1-49"><a href="#cb1-49" tabindex="-1"></a><span class="at">      </span><span class="fu">Overhang</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">default</span><span class="kw">:</span><span class="at"> </span><span class="dv">36</span><span class="at"> </span><span class="kw">}</span><span class="co">  # the length of the reads - 1</span></span>
<span id="cb1-50"><a href="#cb1-50" tabindex="-1"></a><span class="at">      </span><span class="fu">Gtf</span><span class="kw">:</span><span class="at"> fruitfly_gene_model</span></span>
<span id="cb1-51"><a href="#cb1-51" tabindex="-1"></a><span class="at">    </span><span class="fu">out</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">alignment</span><span class="kw">]</span></span>
<span id="cb1-52"><a href="#cb1-52" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" tabindex="-1"></a><span class="at">  </span><span class="fu">index_alignment</span><span class="kw">:</span></span>
<span id="cb1-54"><a href="#cb1-54" tabindex="-1"></a><span class="at">    </span><span class="fu">run</span><span class="kw">:</span><span class="at"> bio-cwl-tools/samtools/samtools_index.cwl</span></span>
<span id="cb1-55"><a href="#cb1-55" tabindex="-1"></a><span class="at">    </span><span class="fu">in</span><span class="kw">:</span></span>
<span id="cb1-56"><a href="#cb1-56" tabindex="-1"></a><span class="at">      </span><span class="fu">bam_sorted</span><span class="kw">:</span><span class="at"> mapping_reads/alignment</span></span>
<span id="cb1-57"><a href="#cb1-57" tabindex="-1"></a><span class="at">    </span><span class="fu">out</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">bam_sorted_indexed</span><span class="kw">]</span></span>
<span id="cb1-58"><a href="#cb1-58" tabindex="-1"></a></span>
<span id="cb1-59"><a href="#cb1-59" tabindex="-1"></a><span class="fu">outputs</span><span class="kw">:</span></span>
<span id="cb1-60"><a href="#cb1-60" tabindex="-1"></a><span class="at">  </span><span class="fu">quality_report_forward</span><span class="kw">:</span></span>
<span id="cb1-61"><a href="#cb1-61" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> File</span></span>
<span id="cb1-62"><a href="#cb1-62" tabindex="-1"></a><span class="at">    </span><span class="fu">outputSource</span><span class="kw">:</span><span class="at"> quality_control_forward/html_file</span></span>
<span id="cb1-63"><a href="#cb1-63" tabindex="-1"></a><span class="at">  </span><span class="fu">quality_report_reverse</span><span class="kw">:</span></span>
<span id="cb1-64"><a href="#cb1-64" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> File</span></span>
<span id="cb1-65"><a href="#cb1-65" tabindex="-1"></a><span class="at">    </span><span class="fu">outputSource</span><span class="kw">:</span><span class="at"> quality_control_reverse/html_file</span></span>
<span id="cb1-66"><a href="#cb1-66" tabindex="-1"></a><span class="at">  </span><span class="fu">bam_sorted_indexed</span><span class="kw">:</span></span>
<span id="cb1-67"><a href="#cb1-67" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> File</span></span>
<span id="cb1-68"><a href="#cb1-68" tabindex="-1"></a><span class="at">    </span><span class="fu">outputSource</span><span class="kw">:</span><span class="at"> index_alignment/bam_sorted_indexed</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The workflow file shows the first 5 steps of the RNA-seq analysis:
<code>quality_control_reverse</code>,
<code>quality_control_forward</code>,
<code>trim_low_quality_bases</code>, <code>mapping_reads</code>, and
<code>index_alignment</code>.</p>
<p>The <code>index_alignment</code> step uses the <code>alignment</code>
output of the <code>mapping_reads</code> step. You do this by
referencing the output of the <code>mapping_reads</code> step in the
<code>in</code> field of the <code>index_alignment</code> step. This is
similar to referencing the outputs of the different steps in the
<code>outputs</code> section.</p>
<div id="default-values" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="default-values" class="callout-inner">
<h3 class="callout-title">Default values<a class="anchor" aria-label="anchor" href="#default-values"></a>
</h3>
<div class="callout-content">
<p>The <code>mapping_reads</code> step needs some extra information
beyond the inputs from the other steps, which is done by providing
<code>default</code> values. If you want, you can read the
<code>bio-cwl-tools/STAR/STAR-Align.cwl</code> file to see how these
extra inputs are transformed into command line options to the
<code>STAR</code> program. This information is provided in the
<code>in</code> field.</p>
</div>
</div>
</div>
<div id="specifying-resources" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="specifying-resources" class="callout-inner">
<h3 class="callout-title">Specifying resources<a class="anchor" aria-label="anchor" href="#specifying-resources"></a>
</h3>
<div class="callout-content">
<p>To run the tool better, it needs more RAM than the default. So there
is a <code>requirements</code> entry inside the
<code>mapping_reads</code> step definition with a
<code>ResourceRequirement</code> to allocate a minimum of 5120 MiB (5
GiB) of RAM.</p>
</div>
</div>
</div>
<p>The newly added <code>mapping_reads</code> step also need an input
not provided by any of our other steps, therefore an additional
workflow-level input is added: a directory that contains the reference
genome necessary for the mapping.</p>
<p>This <code>ref_fruitfly_genome</code> is added in the
<code>inputs</code> field of the workflow and in the YAML input file,
<code>workflow_input_2.yml</code>.</p>
</section><section id="validating-the-workflow"><h2 class="section-heading">Validating the workflow<a class="anchor" aria-label="anchor" href="#validating-the-workflow"></a>
</h2>
<hr class="half-width"><div id="is-this-a-valid-workflow" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="is-this-a-valid-workflow" class="callout-inner">
<h3 class="callout-title">Is this a valid workflow? 🌶<a class="anchor" aria-label="anchor" href="#is-this-a-valid-workflow"></a>
</h3>
<div class="callout-content">
<p>Use cwltool to validate the workflow</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="ex">cwltool</span> <span class="at">--validate</span> rna_seq_workflow_2.cwl</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>A warning is thrown after we validate this workflow.</p>
<pre><code>WARNING Workflow checker warning:
rna_seq_workflow_2.cwl:51:11: Source 'alignment' of type ["File", {"type": "array", "items":
                              "File"}] may be incompatible
rna_seq_workflow_2.cwl:56:7:    with sink 'bam_sorted' of type "File"</code></pre>
<p><br></p>
<div id="should-we-be-concerned-about-this-warning" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="should-we-be-concerned-about-this-warning" class="callout-inner">
<h3 class="callout-title">Should we be concerned about this warning
🌶🌶🌶<a class="anchor" aria-label="anchor" href="#should-we-be-concerned-about-this-warning"></a>
</h3>
<div class="callout-content">
<p>Not all warnings are bad.<br>
Should we be concerned about this warning? If not, why not?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<p>In this case, the outputs of the mapping step may instead either be
just one file, OR an array of files.</p>
<p>It is important that the invoke the <code>mapping</code> step in such
a way that only one file is output, as a single file is the requirement
of the <code>index_alignment</code> step</p>
</div>
</div>
</div>
</div>
</section><section id="running-the-new-workflow"><h2 class="section-heading">Running the new workflow<a class="anchor" aria-label="anchor" href="#running-the-new-workflow"></a>
</h2>
<hr class="half-width"><p>The workflow definition is complete and we now only need to write the
YAML input file.</p>
<div id="accordionSpoiler2" class="accordion spoiler-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button spoiler-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSpoiler2" aria-expanded="false" aria-controls="collapseSpoiler2">
  <h3 class="accordion-header" id="headingSpoiler2">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="eye"></i></div>workflow_input_2.yml (Click to expand)</h3>
</button>
<div id="collapseSpoiler2" class="accordion-collapse collapse" data-bs-parent="#accordionSpoiler2" aria-labelledby="headingSpoiler2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">YAML<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode yaml" tabindex="0"><code class="sourceCode yaml"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">rna_reads_fruitfly_forward</span><span class="kw">:</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="at">  </span><span class="fu">class</span><span class="kw">:</span><span class="at"> File</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="at">  </span><span class="fu">location</span><span class="kw">:</span><span class="at"> rnaseq/GSM461177_1_subsampled.fastqsanger</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="at">  </span><span class="fu">format</span><span class="kw">:</span><span class="at"> http://edamontology.org/format_1930</span><span class="co">  # FASTQ</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">rna_reads_fruitfly_reverse</span><span class="kw">:</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="at">  </span><span class="fu">class</span><span class="kw">:</span><span class="at"> File</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="at">  </span><span class="fu">location</span><span class="kw">:</span><span class="at"> rnaseq/GSM461177_2_subsampled.fastqsanger</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="at">  </span><span class="fu">format</span><span class="kw">:</span><span class="at"> http://edamontology.org/format_1930</span><span class="co">  # FASTQ</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a><span class="fu">ref_fruitfly_genome</span><span class="kw">:</span></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="at">  </span><span class="fu">class</span><span class="kw">:</span><span class="at"> Directory</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="at">  </span><span class="fu">location</span><span class="kw">:</span><span class="at"> rnaseq/dm6-STAR-index</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="fu">fruitfly_gene_model</span><span class="kw">:</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="at">  </span><span class="fu">class</span><span class="kw">:</span><span class="at"> File</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="at">  </span><span class="fu">location</span><span class="kw">:</span><span class="at"> rnaseq/Drosophila_melanogaster.BDGP6.87.gtf</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We have finished the workflow definition and the input file and now
can run the workflow.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">cwltool</span> <span class="at">--cachedir</span> cache rna_seq_workflow_2.cwl workflow_input_2.yml</span></code></pre>
</div>
<div id="challenge-draw-the-workflow" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-draw-the-workflow" class="callout-inner">
<h3 class="callout-title">Challenge: Draw the workflow 🌶<a class="anchor" aria-label="anchor" href="#challenge-draw-the-workflow"></a>
</h3>
<div class="callout-content">
<p>Draw the connecting arrows in the following graph of our workflow.
Also, provide the outputs/inputs of the different steps. You can use for
example Paint or print out the graph.</p>
<figure><img src="../fig/Ep3_empty_graph.png" style='height: "300px"' alt="Ep3 Empty Graph" class="figure mx-auto d-block"></figure></div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<p>To find out how the inputs and the steps are connected to each other,
look at the <code>in</code> field of the different steps.</p>
<figure><img src="../fig/Ep3_graph_answer.png" style='height: "300px"' alt="Ep3 empty graph answer" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
<div id="iterative-working" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="iterative-working" class="callout-inner">
<h3 class="callout-title">Iterative working<a class="anchor" aria-label="anchor" href="#iterative-working"></a>
</h3>
<div class="callout-content">
<p>Working on a workflow is often not something that happens all at
once. Sometimes you already have a shell script ready that can be
converted to a CWL workflow. Other times it is similar to this tutorial,
you start with a single-step workflow and extend it to a multi-step
workflow. This is all iterative working, a continuous work in
progress.</p>
</div>
</div>
</div>
</section><section id="visualising-a-workflow"><h2 class="section-heading">Visualising a workflow<a class="anchor" aria-label="anchor" href="#visualising-a-workflow"></a>
</h2>
<hr class="half-width"><p>To visualise a workflow, a graph can be used. This can be done before
a CWL script is written to visualise how the different steps connect to
each other. It is also possible to make a graph after the CWL script has
been written. This graph can be generated using online tools or the
built-in function in <code>cwltool</code>. When a graph is generated, it
can be used to visualise the steps taken and could make it easier to
explain a workflow to other researchers.</p>
<p>A CWL workflow is a directed acyclic graph (DAG). This means
that:</p>
<ol style="list-style-type: decimal"><li>The workflow has a certain direction, from workflow inputs to step
inputs, from step outputs to other step inputs, and from step outputs to
workflow outputs and</li>
<li>The workflow definition has no cycles.</li>
</ol><div id="cwl-workflow-as-a-dependency-graph" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="cwl-workflow-as-a-dependency-graph" class="callout-inner">
<h3 class="callout-title">CWL workflow as a dependency graph<a class="anchor" aria-label="anchor" href="#cwl-workflow-as-a-dependency-graph"></a>
</h3>
<div class="callout-content">
<p>By being a ‘DAG’, a CWL workflow is a dependency graph. Each input
for a step in the workflow depends on either a workflow-level input or
the presence of a particular output from another step.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="from-cwl-script-to-graph">From CWL script to graph<a class="anchor" aria-label="anchor" href="#from-cwl-script-to-graph"></a></h3>
<p>In this example the workflow is already made, so the graph can be
generated using <a href="https://view.commonwl.org/" class="external-link">cwlviewer</a>
online or using <code>cwltool</code>. First, let’s have a look at <a href="https://view.commonwl.org/" class="external-link">cwlviewer</a>. To use this tool, the
workflow has to be put in a GitHub, GitLab or Git repository. To view
the graph of the workflow enter the URL and click
<code>Parse Workflow</code>.</p>
<div id="push-your-workflow-to-github" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="push-your-workflow-to-github" class="callout-inner">
<h3 class="callout-title">Push your workflow to GitHub 🌶<a class="anchor" aria-label="anchor" href="#push-your-workflow-to-github"></a>
</h3>
<div class="callout-content">
<p>Add your workflow to a git commit and then push that commit to
github.com</p>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Git add / commit / push</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<p>Your solution might look like this</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">git</span> add rna_seq_workflow_2.cwl </span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">"Added my second RNASeq CWL Workflow"</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">git</span> push</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Now it’s time to view your workflow!</p>
<div id="view-your-workflow-in-the-cwl-viewer" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="view-your-workflow-in-the-cwl-viewer" class="callout-inner">
<h3 class="callout-title">View your workflow in the cwl viewer 🌶<a class="anchor" aria-label="anchor" href="#view-your-workflow-in-the-cwl-viewer"></a>
</h3>
<div class="callout-content">
<p>Paste the workflow url into the form on <a href="https://view.commonwl.org/" class="external-link">view.commonwl.org</a></p>
<p>Your workflow url will be something like
<code>https://github.com/alexiswl/cwl-novice-tutorial/blob/main/rna_seq_workflow_2.cwl</code>.</p>
</div>
</div>
</div>
<p>The cwlviewer displays the workflow as a graph, starting with the
input. Then the different steps are shown, each with their input(s) and
output(s). The steps are linked to each other using arrows accompanied
by the input of the next step. The graph ends with the workflow
outputs.</p>
<p>The graph of the RNA-seq workflow looks a follows:</p>
<figure><img src="../fig/Ep3_graph_answer.png" style='height: "400px"' alt="Ep3 graph answer" class="figure mx-auto d-block"></figure></div>
<div class="section level3">
<h3 id="generating-graphs-locally">Generating graphs locally<a class="anchor" aria-label="anchor" href="#generating-graphs-locally"></a></h3>
<p>It is also possible to generate the graph in the command line.
<code>cwltool</code> has a function that makes a graph. The
<code>--print-dot</code> option will print a file suitable for Graphviz
<code>dot</code> program. This is the command to generate a Scalable
Vector Graphic (SVG) file:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">cwltool</span> <span class="at">--print-dot</span> rna_seq_workflow_2.cwl <span class="kw">|</span> <span class="ex">dot</span> <span class="at">-Tsvg</span> <span class="op">&gt;</span> workflow_graph_2.svg</span></code></pre>
</div>
<p>The resulting SVG file displays the same graph as the one in the
cwlviewer. The SVG file can be opened in any web browser and in <a href="https://inkscape.org/" class="external-link">Inkscape</a>, for example. Or opened with
<code>code workflow_graph_2.svg</code> from the terminal.</p>
<div id="windows-only-view-images-from-the-cli-with-wslview" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="windows-only-view-images-from-the-cli-with-wslview" class="callout-inner">
<h3 class="callout-title">Windows Only: View images from the CLI with
wslview<a class="anchor" aria-label="anchor" href="#windows-only-view-images-from-the-cli-with-wslview"></a>
</h3>
<div class="callout-content">
<p>Windows users can run <code>wslview workflow_graph_2.svg</code> in
their terminal to view the graph in the default web browser.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="visualisation-in-vscode">Visualisation in VSCode<a class="anchor" aria-label="anchor" href="#visualisation-in-vscode"></a></h3>
<p><a href="https://marketplace.visualstudio.com/items?itemName=sbg-rabix.benten-cwl" class="external-link"><strong>Benten</strong></a>
is an extension in Visual Studio Code (VSCode) that among other things
visualises a workflow in a graph. When Benten is installed in VSCode,
the tool can be used to visualise the workflow. In the top-right corner
of the VSCode window the CWL viewer can be opened, see the screenshot
below.</p>
<figure><img src="../fig/VSCode_CWL_Preview_(step1).png" style='height: "400px"' alt="VSCode CWL Preview step 1" class="figure mx-auto d-block"></figure><p>In VSCode/Benten the inputs are shown in green, the steps in blue and
the outputs in yellow. This graph looks a little bit different from the
graph made with cwlviewer or <code>cwltool</code>. The graph by
VSCode/Benten doesn’t show the output-input names between the different
steps.</p>
<figure><img src="../fig/VSCode_CWL_Preview_(step2).png" style='height: "400px"' alt="VSCode CWL Preview step 2" class="figure mx-auto d-block"></figure><div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>A multi-step workflow has multiple entries under the
<code>steps</code> section</li>
<li>Workflow development can be an iterative process</li>
<li>A CWL workflow can be represented as a dependency graph, either to
explain your workflow or as a planning tool</li>
</ul></div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/02-shell_to_cwl.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/04-reusing_tools.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/02-shell_to_cwl.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: CWL and Shell Tools
        </a>
        <a class="chapter-link float-end" href="../instructor/04-reusing_tools.html" rel="next">
          Next: Resources for... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/__USERNAME__/__PROJECT__/edit/main/episodes/03-dependency_graphs.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/__USERNAME__/__PROJECT__/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/__USERNAME__/__PROJECT__/" class="external-link">Source</a></p>
				<p><a href="https://github.com/__USERNAME__/__PROJECT__/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:https://www.commonwl.org/#Support" class="external-link">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.5" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.2" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://__USERNAME__.github.io/__PROJECT__/instructor/03-dependency_graphs.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, workflows, Common Workflow Language",
  "name": "Developing Multi-Step Workflows",
  "creativeWorkStatus": "active",
  "url": "https://__USERNAME__.github.io/__PROJECT__/instructor/03-dependency_graphs.html",
  "identifier": "https://__USERNAME__.github.io/__PROJECT__/instructor/03-dependency_graphs.html",
  "dateCreated": "2024-04-29",
  "dateModified": "2024-05-21",
  "datePublished": "2024-05-21"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

